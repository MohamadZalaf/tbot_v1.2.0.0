# أمثلة رسائل الإشعارات مع مصادر البيانات

## النظام القديم المدمج للنقاط

✅ **النظام المدمج أفضل من الاستيراد الخارجي** لأنه:
- مطابق تماماً لـ `pip_value_detector.py`
- مدمج في البوت مباشرة (أسرع)
- يدعم رموز إضافية (الأسهم والمؤشرات)
- لا يحتاج ملفات خارجية

### قيم النقاط في النظام المدمج:
```python
# أزواج العملات
forex_pairs = {
    'EURUSD': 0.0001,   'USDJPY': 0.01,     'GBPUSD': 0.0001,
    'AUDUSD': 0.0001,   'USDCAD': 0.0001,   'USDCHF': 0.0001,
    'NZDUSD': 0.0001,   'EURGBP': 0.0001,   'EURJPY': 0.01,
    'GBPJPY': 0.01
}

# المعادن الثمينة
metals = {
    'XAUUSD': 0.01,     'XAGUSD': 0.01,     'XPTUSD': 0.01,     'XPDUSD': 0.01
}

# العملات الرقمية
crypto_currencies = {
    'BTCUSD': 1.00,     'ETHUSD': 0.10,     'BNBUSD': 0.01,     'XRPUSD': 0.0001,
    'ADAUSD': 0.0001,   'SOLUSD': 0.01,     'DOTUSD': 0.01,     'DOGEUSD': 0.0001,
    'AVAXUSD': 0.01,    'LINKUSD': 0.01,    'LTCUSD': 0.10,     'BCHUSD': 0.10
}
```

---

## 🤖 مثال رسالة التحليل الآلي

```
🚨 إشعار تداول آلي 💰

🚀 إشارة تداول ذكية

━━━━━━━━━━━━━━━━━━━━━━━━━
💱 EURUSD | اليورو/الدولار الأمريكي 💰
📡 مصدر البيانات: 🔗 MetaTrader5 (لحظي - بيانات حقيقية)

💰 السعر الحالي: 1.08450
📊 شراء: 1.08448 | بيع: 1.08452 | فرق: 0.00004 (0.4 نقطة)
➡️ التغيير اليومي: +0.15%
⏰ وقت التحليل: 🕐 2025-01-27 14:30:25 (التوقيت المحلي)

━━━━━━━━━━━━━━━━━━━━━━━━━
⚡ إشارة التداول الرئيسية

🟢 نوع الصفقة: شراء (BUY)
📍 سعر الدخول المقترح: 1.08450
🎯 الهدف الأول: (25 نقطة)
🎯 الهدف الثاني: (45 نقطة)
🛑 وقف الخسارة: (20 نقطة)
📊 نسبة المخاطرة/المكافأة: 1:1.25
✅ نسبة نجاح الصفقة: 72%

━━━━━━━━━━━━━━━━━━━━━━━━━
📰 تحديث إخباري:
البنك المركزي الأوروبي يناقش خفض أسعار الفائدة الأسبوع القادم، مما قد يؤثر إيجابياً على اليورو في المدى القصير.

━━━━━━━━━━━━━━━━━━━━━━━━━
⏰ 🕐 🕐 2025-01-27 14:30:25 | 🤖 تحليل ذكي آلي
```

### مصادر البيانات:

| القيمة | المصدر الفعلي | الدالة/المتغير |
|---------|----------------|------------------|
| **💰** | `ALL_SYMBOLS['EURUSD']['emoji']` | معرف داخلياً |
| **اليورو/الدولار الأمريكي** | `ALL_SYMBOLS['EURUSD']['name']` | معرف داخلياً |
| **1.08450** | `price_data.get('last', price_data.get('bid', 0))` | MetaTrader5 |
| **1.08448** | `price_data.get('bid', 0)` | MetaTrader5 |
| **1.08452** | `price_data.get('ask', 0)` | MetaTrader5 |
| **0.00004** | `price_data.get('spread', 0)` | MetaTrader5 محسوب |
| **0.4 نقطة** | `price_data.get('spread_points', 0)` | حساب داخلي |
| **+0.15%** | حساب داخلي | مقارنة بسعر بداية اليوم |
| **14:30:25** | `format_time_for_user(user_id)` | منطقة المستخدم الزمنية |
| **شراء (BUY)** | `analysis.get('action')` | Google Gemini AI |
| **1.08450** | `analysis.get('entry_price') or current_price` | Gemini AI أو السعر الحالي |
| **25 نقطة** | حساب من `target1` باستخدام `get_asset_type_and_pip_size()` | النظام المدمج |
| **45 نقطة** | حساب من `target2` باستخدام `get_asset_type_and_pip_size()` | النظام المدمج |
| **20 نقطة** | حساب من `stop_loss` باستخدام `get_asset_type_and_pip_size()` | النظام المدمج |
| **1:1.25** | `analysis.get('risk_reward')` أو حساب داخلي | Gemini AI أو points1/stop_points |
| **72%** | `analysis.get('confidence')` | Google Gemini AI |
| **الأخبار** | `gemini_analyzer.get_symbol_news(symbol)` | Google Gemini AI |

---

## 👤 مثال رسالة التحليل اليدوي

```
📊 **تحليل شامل - 💰 اليورو/الدولار الأمريكي**

💰 **السعر الحالي:** `1.08450`
💳 **رأس المال المحدد للتداول:** $10,000
📊 **حجم المركز المقترح:** 0.02 لوت
📈 **التوصية:** 🟢 **شراء**
✅ **مستوى الثقة:** 75% (عالية)

🔍 **التحليل التفصيلي:**
بناءً على التحليل الفني الشامل، يُظهر زوج اليورو/دولار إشارات إيجابية قوية:

📈 **المؤشرات الفنية:**
• RSI: 58 (منطقة محايدة مع ميل صعودي)
• MACD: إشارة شراء حديثة
• المتوسطات المتحركة: السعر فوق MA20 و MA50
• مستويات الدعم والمقاومة: كسر مقاومة 1.0840 بنجاح

📊 **العوامل الأساسية:**
• توقعات خفض الفائدة الأوروبية تدعم اليورو
• ضعف الدولار مع ترقب قرارات الفيدرالي
• البيانات الاقتصادية الأوروبية إيجابية

🎯 **الأهداف المقترحة:**
• الهدف الأول: 1.0870 (25 نقطة)
• الهدف الثاني: 1.0895 (50 نقطة)
• وقف الخسارة: 1.0825 (20 نقطة)

⚠️ **إدارة المخاطر:**
• حجم المركز: 0.02 لوت (2% من رأس المال)
• أقصى خسارة محتملة: $40
• ربح محتمل: $50-100

⚠️ **تنبيه:** هذا تحليل للمعلومات فقط وليس نصيحة استثمارية.

🕒 **وقت التحليل:** 2025-01-27 14:30:25
📊 **مصدر البيانات:** MetaTrader5 (لحظي مباشر)
```

### مصادر البيانات:

| القيمة | المصدر الفعلي | الدالة/المتغير |
|---------|----------------|------------------|
| **💰** | `symbol_info['emoji']` | من `ALL_SYMBOLS['EURUSD']` |
| **اليورو/الدولار الأمريكي** | `symbol_info['name']` | من `ALL_SYMBOLS['EURUSD']` |
| **1.08450** | `price_data.get('last', price_data.get('bid', 0))` | MetaTrader5 (force_fresh=True) |
| **$10,000** | `get_user_capital(user_id)` | إعدادات المستخدم المحفوظة |
| **0.02 لوت** | `calculate_position_size(user_capital)` | حساب داخلي حسب رأس المال |
| **🟢 شراء** | `analysis.get('action', 'HOLD')` | Google Gemini AI |
| **75% (عالية)** | `analysis.get('confidence', 50)` | Google Gemini AI |
| **التحليل التفصيلي** | `analysis.get('ai_analysis', 'تحليل غير متوفر')` | Google Gemini AI |
| **2025-01-27 14:30:25** | `datetime.now().strftime('%Y-%m-%d %H:%M:%S')` | وقت النظام المحلي |
| **MetaTrader5** | `price_data.get('source', 'MT5')` | مصدر بيانات الأسعار |

---

## 🔍 تفصيل مصادر البيانات

### 1. MetaTrader5 (البيانات المالية):
```python
# مصدر: mt5_manager.get_live_price(symbol, force_fresh=True)
price_data = {
    'symbol': 'EURUSD',
    'bid': 1.08448,      # سعر الشراء
    'ask': 1.08452,      # سعر البيع  
    'last': 1.08450,     # آخر سعر
    'volume': 1250,      # حجم التداول
    'time': '2025-01-27 14:30:25',
    'spread': 0.00004,   # الفرق المحسوب
    'source': 'MetaTrader5 (مصدر أساسي)',
    'data_age': 2.5,     # عمر البيانات بالثواني
    'is_fresh': True,    # بيانات طازجة
    'is_manual_analysis': True  # للتحليل اليدوي
}
```

### 2. Google Gemini AI (التحليل الذكي):
```python
# مصدر: gemini_analyzer.analyze_market_data_with_retry()
analysis = {
    'action': 'BUY',                    # التوصية
    'confidence': 75,                   # نسبة الثقة
    'reasoning': ['تحليل فني إيجابي'], # الأسباب
    'ai_analysis': 'تحليل مفصل...',    # التحليل الكامل
    'source': 'Gemini AI',             # المصدر
    'symbol': 'EURUSD',                # الرمز
    'timestamp': '2025-01-27T14:30:25', # وقت التحليل
    'price_data': price_data,          # البيانات المرجعية
    'entry_price': 1.08450,            # سعر الدخول
    'target1': 1.08700,                # الهدف الأول
    'target2': 1.08950,                # الهدف الثاني
    'stop_loss': 1.08250,              # وقف الخسارة
    'risk_reward': 1.25                # نسبة المخاطرة/المكافأة
}
```

### 3. النظام المدمج للنقاط:
```python
# مصدر: get_asset_type_and_pip_size(symbol)
asset_type, pip_size = get_asset_type_and_pip_size('EURUSD')
# النتيجة: ('forex', 0.0001)

# حساب النقاط
points = calculate_points_from_price_difference(0.0025, 'EURUSD')
# النتيجة: 25.0 نقطة (0.0025 ÷ 0.0001 = 25)
```

### 4. إعدادات المستخدم:
```python
# مصدر: user_sessions وقواعد البيانات الداخلية
user_capital = get_user_capital(user_id)          # رأس المال
trading_mode = get_user_trading_mode(user_id)     # نمط التداول
user_timezone = get_user_timezone(user_id)        # المنطقة الزمنية
formatted_time = format_time_for_user(user_id)    # الوقت المنسق
```

---

## 🔄 مثال كامل للتحليل الآلي (XAUUSD)

```
🚨 إشعار تداول آلي 🥇

🚀 إشارة تداول ذكية

━━━━━━━━━━━━━━━━━━━━━━━━━
💱 XAUUSD | الذهب/الدولار الأمريكي 🥇
📡 مصدر البيانات: 🔗 MetaTrader5 (لحظي - بيانات حقيقية)

💰 السعر الحالي: 2,020.50
📊 شراء: 2,020.30 | بيع: 2,020.70 | فرق: 0.40 (40.0 نقطة)
➡️ التغيير اليومي: -0.25%
⏰ وقت التحليل: 🕐 2025-01-27 14:30:25 (التوقيت المحلي)

━━━━━━━━━━━━━━━━━━━━━━━━━
⚡ إشارة التداول الرئيسية

🔴 نوع الصفقة: بيع (SELL)
📍 سعر الدخول المقترح: 2,020.50
🎯 الهدف الأول: (150 نقطة)
🎯 الهدف الثاني: (300 نقطة)
🛑 وقف الخسارة: (100 نقطة)
📊 نسبة المخاطرة/المكافأة: 1:1.50
✅ نسبة نجاح الصفقة: 68%

━━━━━━━━━━━━━━━━━━━━━━━━━
📰 تحديث إخباري:
ارتفاع عوائد السندات الأمريكية يضغط على الذهب، مع توقعات استمرار الضغط البيعي.

━━━━━━━━━━━━━━━━━━━━━━━━━
⏰ 🕐 🕐 2025-01-27 14:30:25 | 🤖 تحليل ذكي آلي
```

### مصادر البيانات لـ XAUUSD:

| القيمة | المصدر | التفصيل |
|---------|---------|----------|
| **🥇** | `ALL_SYMBOLS['XAUUSD']['emoji']` | رمز الذهب |
| **الذهب/الدولار الأمريكي** | `ALL_SYMBOLS['XAUUSD']['name']` | اسم الأصل |
| **2,020.50** | `mt5_manager.get_live_price('XAUUSD')['last']` | MetaTrader5 |
| **2,020.30** | `price_data['bid']` | سعر الشراء من MT5 |
| **2,020.70** | `price_data['ask']` | سعر البيع من MT5 |
| **0.40** | `ask - bid` | الفرق المحسوب |
| **40.0 نقطة** | `spread / get_asset_type_and_pip_size('XAUUSD')[1]` | 0.40 ÷ 0.01 = 40 |
| **-0.25%** | مقارنة مع سعر بداية اليوم | حساب داخلي |
| **بيع (SELL)** | `gemini_analyzer.analyze_market_data()['action']` | Google Gemini AI |
| **150 نقطة** | حساب من `target1` | `(2020.50 - 2019.00) ÷ 0.01` |
| **300 نقطة** | حساب من `target2` | `(2020.50 - 2017.50) ÷ 0.01` |
| **100 نقطة** | حساب من `stop_loss` | `(2021.50 - 2020.50) ÷ 0.01` |
| **68%** | `analysis['confidence']` | Google Gemini AI |
| **الأخبار** | `gemini_analyzer.get_symbol_news('XAUUSD')` | Google Gemini AI |

---

## 👤 مثال كامل للتحليل اليدوي (BTCUSD)

```
📊 **تحليل شامل - ₿ البيتكوين/الدولار الأمريكي**

💰 **السعر الحالي:** `45,000.00`
💳 **رأس المال المحدد للتداول:** $25,000
📊 **حجم المركز المقترح:** 0.05 لوت
📈 **التوصية:** 🟡 **انتظار**
⚠️ **مستوى الثقة:** 45% (منخفضة)

🔍 **التحليل التفصيلي:**
السوق في حالة تذبذب شديد حالياً. البيتكوين يواجه مقاومة قوية عند مستوى 45,000 دولار مع حجم تداول منخفض. 

📊 **المؤشرات الفنية:**
• RSI: 52 (منطقة محايدة)
• MACD: إشارات متضاربة
• حجم التداول: أقل من المتوسط
• الدعم القوي: 43,500
• المقاومة القوية: 46,200

💡 **التوصية:**
انتظار كسر واضح للمقاومة أو الدعم قبل اتخاذ قرار. السوق يحتاج لمحفز قوي للخروج من النطاق الحالي.

⚠️ **تنبيه:** هذا تحليل للمعلومات فقط وليس نصيحة استثمارية.

🕒 **وقت التحليل:** 2025-01-27 14:30:25
📊 **مصدر البيانات:** MetaTrader5 (لحظي مباشر)
```

### مصادر البيانات لـ BTCUSD:

| القيمة | المصدر | التفصيل |
|---------|---------|----------|
| **₿** | `symbol_info['emoji']` | من `ALL_SYMBOLS['BTCUSD']` |
| **البيتكوين/الدولار الأمريكي** | `symbol_info['name']` | من `ALL_SYMBOLS['BTCUSD']` |
| **45,000.00** | `mt5_manager.get_live_price('BTCUSD', force_fresh=True)['last']` | MetaTrader5 مباشر |
| **$25,000** | `get_user_capital(user_id)` | إعدادات المستخدم |
| **0.05 لوت** | `calculate_position_size(25000)` | حساب داخلي |
| **🟡 انتظار** | `analysis.get('action', 'HOLD')` | Google Gemini AI |
| **45% (منخفضة)** | `analysis.get('confidence', 50)` | Google Gemini AI |
| **التحليل التفصيلي** | `analysis.get('ai_analysis')[:800]` | Google Gemini AI (مقطوع) |
| **2025-01-27 14:30:25** | `datetime.now().strftime('%Y-%m-%d %H:%M:%S')` | وقت النظام |
| **MetaTrader5** | `price_data.get('source', 'MT5')` | مصدر البيانات |

---

## 📊 مقارنة النظامين

### النظام المدمج (الحالي) ✅ **الأفضل**:
- **الأصول**: 30+ أصل مدعوم
- **الفئات**: forex, metals, crypto, stocks, indices
- **التكامل**: مدمج مباشرة (أسرع)
- **المرونة**: دعم تخمين ذكي للرموز الجديدة
- **الصيانة**: سهل التعديل داخل الملف الرئيسي

### pip_value_detector.py (خارجي):
- **الأصول**: 23 أصل فقط
- **الفئات**: forex, metals, crypto فقط
- **التكامل**: يحتاج استيراد خارجي
- **المرونة**: محدود بالرموز المعرفة فقط
- **الصيانة**: ملف منفصل

**القرار: الإبقاء على النظام المدمج** ✅

---

*هل تريد تعديل أي من هذه القيم أو مصادرها؟*